<!doctype html>
<html lang="ja">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <title>サイト情報確認 - t_o_d ツール</title>
        <meta name="title" content="サイト情報確認 - t_o_d ツール" />
        <meta name="description" content="サイト情報確認ツールです。" />
        <meta
            name="keywords"
            content="t_o_d, tool, tech, サイト情報確認, プログラミング"
        />
        <meta name="author" content="t_o_d" />
        <meta name="robots" content="index, follow" />
        <meta name="language" content="Japanese" />

        <!-- Open Graph -->
        <meta property="og:type" content="article" />
        <meta property="og:url" content="https://github.com/Kamekure-Maisuke" />
        <meta property="og:title" content="サイト情報確認 - t_o_d ツール" />
        <meta
            property="og:description"
            content="これサイト情報確認ツールです。"
        />
        <meta property="og:locale" content="ja_JP" />
        <meta property="og:site_name" content="t_o_d Portfolio" />

        <!-- Theme Color -->
        <meta name="theme-color" content="#1f2937" />

        <link
            rel="stylesheet"
            href="/pico/css/pico.min.css"
            fetchpriority="high"
        />

        <!-- Structured Data (JSON-LD) for Article -->
        <script type="application/ld+json">
            {
                "@context": "https://schema.org",
                "@type": "Tool",
                "name": "t_o_d Tool",
                "description": "t_o_dのサイト情報確認ツールです。",
                "author": {
                    "@type": "Person",
                    "name": "t_o_d"
                }
            }
        </script>
    </head>

    <body>
        <header class="container" role="banner">
            <nav>
                <ul>
                    <li><a href="/">ホーム</a></li>
                    <li><a href="/blogs/">ブログ</a></li>
                    <li><a href="/tools/">ツール</a></li>
                </ul>
            </nav>
        </header>

        <main class="container" role="main" aria-label="サイト情報確認 Tool">
            <header>
                <hgroup>
                    <h1>サイト情報確認ツール</h1>
                    <p>
                        URLを入力すると、そのサイトのサーバー情報やSSL/TLS情報を確認できます。
                    </p>
                </hgroup>
            </header>

            <section aria-labelledby="ua-tool-heading">
                <h2 id="ua-tool-heading" hidden>サイト情報確認ツール</h2>

                <form id="site-info-form">
                    <label for="url-input">
                        URL
                        <input
                            type="url"
                            id="url-input"
                            name="url"
                            placeholder="https://example.com"
                            required
                        />
                    </label>
                    <button type="submit">情報を取得</button>
                </form>

                <div id="loading" hidden aria-live="polite">
                    <p aria-busy="true">情報を取得中...</p>
                </div>

                <div id="error" hidden role="alert"></div>

                <div id="result" hidden>
                    <article>
                        <header>
                            <h3>サイト情報</h3>
                        </header>
                        <dl id="site-info-data"></dl>
                    </article>
                </div>
            </section>

            <footer role="contentinfo">
                <small>&copy; 2025 t_o_d. All rights reserved.</small>
            </footer>
        </main>

        <script>
            const form = document.getElementById("site-info-form");
            const urlInput = document.getElementById("url-input");
            const loading = document.getElementById("loading");
            const error = document.getElementById("error");
            const result = document.getElementById("result");
            const siteInfoData = document.getElementById("site-info-data");

            form.addEventListener("submit", async (e) => {
                e.preventDefault();

                const url = urlInput.value.trim();
                if (!url) {
                    return;
                }

                // リセット
                loading.hidden = false;
                error.hidden = true;
                result.hidden = true;
                siteInfoData.innerHTML = "";

                try {
                    // APIエンドポイントを呼び出し
                    const response = await fetch("/api/site-info", {
                        method: "POST",
                        headers: {
                            "Content-Type": "application/json",
                        },
                        body: JSON.stringify({ url }),
                    });

                    const data = await response.json();

                    if (!response.ok || !data.success) {
                        throw new Error(data.error || "Failed to fetch site information");
                    }

                    displayInfo(data.info);

                    loading.hidden = true;
                    result.hidden = false;
                } catch (err) {
                    loading.hidden = true;
                    error.hidden = false;
                    error.innerHTML = `<p><strong>エラー:</strong> ${escapeHtml(err.message)}</p><p>このサイトの情報を取得できませんでした。</p>`;
                }
            });

            function displayInfo(info) {
                siteInfoData.innerHTML = "";
                for (const [key, value] of Object.entries(info)) {
                    const dt = document.createElement("dt");
                    dt.textContent = key;
                    const dd = document.createElement("dd");
                    dd.textContent = value;
                    siteInfoData.appendChild(dt);
                    siteInfoData.appendChild(dd);
                }
            }

            function escapeHtml(unsafe) {
                return unsafe
                    .replace(/&/g, "&amp;")
                    .replace(/</g, "&lt;")
                    .replace(/>/g, "&gt;")
                    .replace(/"/g, "&quot;")
                    .replace(/'/g, "&#039;");
            }
        </script>
    </body>
</html>
